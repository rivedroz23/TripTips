<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.1.0/mapbox-gl.css' rel='stylesheet' />
    <!-- <link href="https://fonts.googleapis.com/css?family=Yellowtail&display=swap" rel="stylesheet"> -->
    <link href="https://fonts.googleapis.com/css?family=Oswald&display=swap" rel="stylesheet">
    <title>TripTips</title>

    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">
  </head>
  <body>
      <div class="head">
     <!-- <h1>&nbsp;&nbsp;</h1>-->
     &nbsp;&nbsp;<img src="/img/tripTipsLogo.png" width="255" height="83">
      </div>
        <div class="container">
      <% include ./partials/alerts %>
      <%- body %>
    </div>

    <div id='map' style='width: 400px; height: 300px;'></div>

    

    <script src="//code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v1.1.0/mapbox-gl.js'></script>
    <%- script %>

    map.on('load', function() {
 
      // Add a layer showing the places.
      map.addLayer({
      "id": "places",
      "type": "symbol",
      "source": {
      "type": "geojson",
      "data": {
      "type": "FeatureCollection",
      "features": [{
      "type": "Feature",
      "properties": {
      "description": "<strong>Make it Mount Pleasant</strong><p>Make it Mount Pleasant is a handmade and vintage market and afternoon of live entertainment and kids activities. 12:00-6:00 p.m.</p>",
      "icon": "theatre"
      },
      "geometry": {
      "type": "Point",
      "coordinates": [-122.331976, 47.602331]
      }
      }, {
        var popup = new mapboxgl.Popup({
          closeButton: false,
          closeOnClick: false
          });
           
          map.on('mouseenter', 'places', function(e) {
          // Change the cursor style as a UI indicator.
          map.getCanvas().style.cursor = 'pointer';
           
          var coordinates = e.features[0].geometry.coordinates.slice();
          var description = e.features[0].properties.description;
           
          // Ensure that if the map is zoomed out such that multiple
          // copies of the feature are visible, the popup appears
          // over the copy being pointed to.
          while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
          coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
          }
           
          // Populate the popup and set its coordinates
          // based on the feature found.
          popup.setLngLat(coordinates)
          .setHTML(description)
          .addTo(map);
          });
           
          map.on('mouseleave', 'places', function() {
          map.getCanvas().style.cursor = '';
          popup.remove();
          });
          });



  </body>
</html>
